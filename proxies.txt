import random

# Put your proxies in a list
PROXIES = [
    "geo.iproyal.com:12321:oFC96iDBblkT6QIm:Aky1QjCFLp2cdVrT",
    # You can add more here if you get more proxies
]

def get_browser():
    options = uc.ChromeOptions()
    options.binary_location = "/usr/bin/google-chrome"  # Render Chrome path
    options.add_argument("--headless=new")
    options.add_argument("--disable-gpu")
    options.add_argument("--no-sandbox")
    options.add_argument("--disable-dev-shm-usage")
    options.add_argument("--window-size=1920,1080")
    options.add_argument("user-agent=Mozilla/5.0")

    # Pick a random proxy from the list
    proxy = random.choice(PROXIES)
    host, port, user, pwd = proxy.split(":")
    options.add_argument(f"--proxy-server=http://{host}:{port}")

    # Start browser
    browser = uc.Chrome(options=options)

    # Handle proxy authentication
    try:
        browser.execute_cdp_cmd(
            "Network.enable", {}
        )
        browser.execute_cdp_cmd(
            "Network.setExtraHTTPHeaders",
            {"headers": {"Proxy-Authorization": "Basic " + 
             base64.b64encode(f"{user}:{pwd}".encode()).decode()}}
        )
    except Exception as e:
        print(f"⚠️ Proxy auth error: {e}")

    return browser